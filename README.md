# Joel Villarreal's Project 7

## Approximating u(x) Such That u′′(x) + 3u′(x) + 2u(x) = 4x^2, u(1) = 1, u(2) = 6

- Using the fact that the following equation:
  - u′′(x) + P(x)u′(x) + Q(x)u = f(x), u(a) = α, u(b) = β
- can be rewriten as: 
  - (**) (1 + h/2 * P_i)u_(i+1) + (−2 + h/2 * Q_i)u_i + (1 − h/2 * P_i)u_(i−1) = 
    h^2f_i
- Where: h = (b - a) / N
- Where: P(x) = 3, Q(x) = 2, a = 1, b = 6, u_0 = 1, u_N = 6, h = 1 / N,
- Implies:
  - c1 * u_(i-1) + c2 * u_i + c3 * u_(i+1) = h^2 * 4x_i^2
- Where
  - c1 = 1 - 3/2 * h, c2 = -2 + 2h^2, c3 = 1 + 3/2 * h
- Implies:
  - A**u** = **F**
- Where:
  - **u** = (u_1, u_2, ..., u_(n-1))^T
  - A is a diagonal matrix with c1, c2, and c3 along its three centermost 
    top-left to bottom-right digaonals
  - **F** = 4h^2(x_1^2, x_2^2, ..., x_(n-1)^2)^T - (c1, 0, ..., 0, 6c3)
- Now, we can solve A**u** = **F**, for **u** in MATLAB

### (a) Use N = 10 to plot the approximation, u(x) vs x.

#### Findings

- With 11 points (N = 10), we can see that the u(x) function that solves:
  - u′′(x) + 3u′(x) + 2u(x) = 4x^2, u(1) = 1, u(2) = 6
- is a concave down function with a positive, decreasing slope.
- The plot that demonstrates these findings can be generated by ODE.m.
  
### (b) Use N = 40 to plot the approximation along with the exact solution u_(exact)(x).

#### Findings

- It can be seen that 40 points do a great job at generation the solution to the 
  following equation:
  - u′′(x) + 3u′(x) + 2u(x) = 4x^2, u(1) = 1, u(2) = 6
- Comparing the approximation to the exact value of u(x), the error is 
  negligible.
- The plot that demonstrates these findings can be generated by ODE.m

## Computing the Error of Composite Trapezoid Rule

- Using 
  - |E_T| <= (k * (b - a)^3) / (12 * n^2)
    - With k s.t. |f''(x)| <= k
- We know that the indefinite integral from [a, b] of sin(x) with respect to x
  will have an error less than 10^(-4) if we choose n to be 161
- To compute the actual error, matlab is necessary

### 3(a) using n = 161, compute the actual error of the given indefinite integral

#### Findings

- The actual error when using n = 161 turns out to be: 
6.3460*10^(-5)
- This makes sense, as we were expecting an error of less than 10^(-4) according
  to the error bound theorem for the composoite trapezoid rule given in class
- The file used to generate this result is in TrapezoidError.m

## The Code

### ODE.m

- ODE.m has the code for approximating u(x) such that:
  - u′′(x) + 3u′(x) + 2u(x) = 4x^2, u(1) = 1, u(2) = 6
- To generate the plot which demonstrates the findings for part (a):
  - Go to the 21st and 22nd line in the code and make sure that N = 10 is 
    uncommented and that N = 40 is commented
  - Go to lines 79 - 87 and make sure: 
    - lines 80 - 82 are uncommented
    - lines 85 - 87 are commented
- To generate the plot which demonstrates the findings for part (b):
  - Go to the 21st and 22nd line in the code and make sure that N = 10 is 
    commented and that N = 40 is uncommented
  - Go to lines 79 - 87 and make sure: 
    - lines 80 - 82 are commented
    - lines 85 - 87 are uncommented
- Once the desired lines of code are uncommented, hit the run button and the 
  plot will generate

### TrapezoidError.m

- TrapezoidError.m has the code for calculating the error when using 162 points 
  (n = 161) to approximate the indefinite integral from [a, b] of sin(x) with 
  respect to x
